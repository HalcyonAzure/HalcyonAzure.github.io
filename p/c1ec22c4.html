<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon-pic.png"><link rel="icon" href="/img/favicon-pic.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="HalcyonAzure"><meta name="keywords" content=""><meta name="description" content="第二十章：分页：较小的表   对于线性页表，只要知道第一个Page的地址，存于寄存器当中，就可以通过这个地址依次陆续推算下一个或后面任意一个有效的地址范围。对于多级页表，通过多次搜索，依旧可以在只有最初的页表的地址的情况下，通过多次的偏移查询来定位到最后需要的特定地址。   这里取例子说明算法，具体答案通过-c参数可直接输出 这里以seed为0的时候为例 首先，在README.md中可以得到以下"><meta property="og:type" content="article"><meta property="og:title" content="OSTEP：分页的计算"><meta property="og:url" content="https://halc.top/p/c1ec22c4"><meta property="og:site_name" content="Halcyon Zone"><meta property="og:description" content="第二十章：分页：较小的表   对于线性页表，只要知道第一个Page的地址，存于寄存器当中，就可以通过这个地址依次陆续推算下一个或后面任意一个有效的地址范围。对于多级页表，通过多次搜索，依旧可以在只有最初的页表的地址的情况下，通过多次的偏移查询来定位到最后需要的特定地址。   这里取例子说明算法，具体答案通过-c参数可直接输出 这里以seed为0的时候为例 首先，在README.md中可以得到以下"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-05-12T13:41:23.000Z"><meta property="article:modified_time" content="2022-05-12T13:41:23.000Z"><meta property="article:author" content="HalcyonAzure"><meta property="article:tag" content="OS"><meta name="twitter:card" content="summary_large_image"><meta name="referrer" content="no-referrer-when-downgrade"><script async src="https://umami.azsyc.com/script.js" data-website-id="ab8bb282-3900-4ec9-a4dd-6076b4af581c"></script><title>OSTEP：分页的计算 - Halcyon Zone</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/round.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"halc.top",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"c4f509f89fec4843f255dfb1ae66ca2b",google:null,tencent:{sid:null,cid:null},leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!0},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null},gtag:null,woyaola:null,cnzz:null},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>if(!Fluid.ctx.dnt){var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c4f509f89fec4843f255dfb1ae66ca2b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Halcyon Zone" type="application/atom+xml">
</head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Halcyon</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/links/" target="_self"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/post.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="OSTEP：分页的计算"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-05-12 21:41" pubdate>2022年5月12日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i>935 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i>8 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">OSTEP：分页的计算</h1><div class="markdown-body"><h2 id="第二十章分页较小的表"><a class="markdownIt-Anchor" href="#第二十章分页较小的表"></a> 第二十章：分页：较小的表</h2><ol><li><p>对于线性页表，只要知道第一个<code>Page</code>的地址，存于寄存器当中，就可以通过这个地址依次陆续推算下一个或后面任意一个有效的地址范围。对于多级页表，通过多次搜索，依旧可以在只有最初的页表的地址的情况下，通过多次的偏移查询来定位到最后需要的特定地址。</p></li><li><p>这里取例子说明算法，具体答案通过<code>-c</code>参数可直接输出</p><p>这里以<code>seed</code>为<code>0</code>的时候为例</p><p>首先，在<code>README.md</code>中可以得到以下信息</p><ul><li>Page Size: 32 bytes</li><li>Virtual Address Space：32 KB(1024个分页 2^15)<ul><li>虚拟地址需要 15 bits (<code>VPN</code> 占 10 bit，<code>offset</code> 占 5 bit)</li></ul></li><li>Physical Memory: 128个分页(2^12)<ul><li>物理地址需要 12 bits (<code>PFN</code> 占 7bit, <code>offset</code> 占 5 bit )</li></ul></li><li>Virtual Address Space 的前五位对应了<code>Page Directory</code>的索引</li></ul><p>通过<code>seed</code>生成<code>0</code>对应的地址数据，用于<code>PDE</code>查表，内容如下</p><details><summary>Page Content</summary><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs sh">page   0:1b1d05051d0b19001e00121c1909190c0f0b0a1218151700100a061c06050514<br>page   1:0000000000000000000000000000000000000000000000000000000000000000<br>page   2:121b0c06001e04130f0b10021e0f000c17091717071e001a0f0408120819060b<br>page   3:7f7f7f7fcd7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f887f7f7f7f7f7f7f7fb9<br>page   4:0b041004051c13071b131d0e1b150107080507071b0e1b0411001c000c181e00<br>page   5:17131d0a1202111906081507081d1e041b1101121301171902140e070e040a14<br>page   6:0000000000000000000000000000000000000000000000000000000000000000<br>page   7:0000000000000000000000000000000000000000000000000000000000000000<br>page   8:11101a120f10180a11151e151d0c12170a081e0a1e1a06191e08141702190915<br>page   9:0000000000000000000000000000000000000000000000000000000000000000<br>page  10:0000000000000000000000000000000000000000000000000000000000000000<br>page  11:0910141d04011a18170e150c050c18181d1b151016051c16120d13131b11060d<br>page  12:060b16191c05141d01141a0a07120d050e0c110f090b19071100160a0108071d<br>page  13:19100b0e000614140f1d0e091a08121519180b0101161d0a0d16140814090b10<br>page  14:1218140b000d1c0a07040f10020c141d0d0d0e060c140c12191e1b0b00120e07<br>page  15:0000000000000000000000000000000000000000000000000000000000000000<br>page  16:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fea7f7f7f<br>page  17:0000000000000000000000000000000000000000000000000000000000000000<br>page  18:7f7f7f7f7f7fab7f7f7f8e7f7f7fdd7f7f7f7f7f7f7f8b7f7f7f7f7f7f7f7f7f<br>page  19:00130001061402011e0d1b060d0b050a1e170b0c081016150e011c0c0c00041a<br>page  20:1a190402020c1d110807030419041a190411001a11170f151c111b0a03000719<br>page  21:0b081b0e1c151e121e050d111e111a130f0c0b09061d101a1b1d070a13090417<br>page  22:1212150f081b0a0e130f1d1d1c1c120f150608010500140418151e0c1c0e0a03<br>page  23:1d0f030b0c0f1e1e1113140f0f091502091b071d1e110102060a03180b07010b<br>page  24:0000000000000000000000000000000000000000000000000000000000000000<br>page  25:03031c031b0e0e0a0c0b110a1907070e1c0016000c170d0d070e070814121c1e<br>page  26:090e1d18081115180d0c170d070e1d040e130e06001513000917131004150e15<br>page  27:0000000000000000000000000000000000000000000000000000000000000000<br>page  28:0f1d0f0a0211070b0b17071d170e1b0b0b04180c0f0e140b1c0d0b0c171e1a0e<br>page  29:17081e031b010710120c030708171c120118090a10071c050c08101113100c13<br>page  30:7f7f7f7f7f847f7f7f7f977fbd7f7ff47f7f7f7f7f7f7f7f7f7f7f7f7f7f9c7f<br>page  31:7f7f7f7f7f7fd07f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  32:0000000000000000000000000000000000000000000000000000000000000000<br>page  33:7f7f7f7f7f7f7f7fb57f9d7f7f7f7f7f7f7f7f7f7f7f7f7f7f7ff6b17f7f7f7f<br>page  34:0413050d0c02161518101105060710190b1b16160a031d1a0c1a1b0a0f0a151c<br>page  35:0000000000000000000000000000000000000000000000000000000000000000<br>page  36:1d1313160c0c1400050a07130b1b110c0c150c14010d0804100f11171b0f090e<br>page  37:1e0f0a0d0c100c021e1e05070d15001913081a1409101e01151a150412180c12<br>page  38:0000000000000000000000000000000000000000000000000000000000000000<br>page  39:1b111e171108150e160c0f001601151218081506100a1e1e06110a1e1c121615<br>page  40:0d030b1007190b0709191c1d0017100307080c0e1d01151a0b07060904110700<br>page  41:7f7f7f7f7f7f7f7fe57f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f8d7f7f7f7f7f<br>page  42:03041501111c1015001312110c0b1e01001d050306181d000d030806140a050f<br>page  43:190802041311011e0e0916000d141d171b030d00080b0a0b180519100a11050f<br>page  44:7f7f7f7f7f7fcc7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fa27f7f7f7f7f7f<br>page  45:7fb27fef7f7f7f7fa4f57f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  46:0000000000000000000000000000000000000000000000000000000000000000<br>page  47:070a0f1002090b0c0e0d020613190f0402040b111410110a14160c19171c0e0a<br>page  48:0000000000000000000000000000000000000000000000000000000000000000<br>page  49:1e0a0f0702030d13101003010b1d05080e1c1d00140714171b151a1804011610<br>page  50:161b040706011a0f020d0d181704130f0004140b1d0f15040e1619060c0e0d0e<br>page  51:14000f1a070a1a0511071d180d02090f1c0311151019101d12120d120b110905<br>page  52:0000000000000000000000000000000000000000000000000000000000000000<br>page  53:0f0c18090e121c0f081713071c1e191b09161b150e030d121c1d0e1a08181100<br>page  54:1901050f031b1c090d11081006090d121008070318031607081614160f1a0314<br>page  55:0000000000000000000000000000000000000000000000000000000000000000<br>page  56:0000000000000000000000000000000000000000000000000000000000000000<br>page  57:1c1d1602020b000a001e19021b0606141d03000b00121a05030a1d041d0b0e09<br>page  58:0000000000000000000000000000000000000000000000000000000000000000<br>page  59:0000000000000000000000000000000000000000000000000000000000000000<br>page  60:0000000000000000000000000000000000000000000000000000000000000000<br>page  61:010510020c0a0c031c0e1a1e0a0e150d09161b1c130b1e1302021701000c100d<br>page  62:7f7f7fa87f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  63:0612060a1d1b19010407181a12161902021a010601001a0a0404141e0f1b0f11<br>page  64:18121708080d1e161d10111e0518181a1704141c110b1d110c13180700101d15<br>page  65:7f7f7f7f7f7f7f7f7f7f997f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  66:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fd77f7f<br>page  67:0000000000000000000000000000000000000000000000000000000000000000<br>page  68:121216020f060c0f0a0c16011d120511020f150d09141c1b0b1a03011e171311<br>page  69:190a19020d0a0d190f1e1a03090016001b050c01090c0117160b1902010b1b17<br>page  70:0000000000000000000000000000000000000000000000000000000000000000<br>page  71:7f7f7f7f7f7f7f7f7f7f7f857f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  72:180c0018050c0b030a051314000e111b0f02011a181a081402190a1d0e011c13<br>page  73:0000000000000000000000000000000000000000000000000000000000000000<br>page  74:0d0b1e08180d0b011a151b0d14030c06011d0604060b10041e1e040c151b0f1c<br>page  75:1a1c011b00141c0f0c0a1c1c13160a041e14081e120a1b021804030816120d04<br>page  76:0c11150c1b1d1e01191b041d03061d191108070c0013011702000817190f1d03<br>page  77:1c061606001b1a0205071c0b190d0b171308121519141312021d16081513140b<br>page  78:0e02171b1c1a1b1c100c1508191a1b121d110d141e1c1802120f131a07160306<br>page  79:1e1b1516071708030e0a050d1b0d0d1510041c0d180c190c06061d12010c0702<br>page  80:1b081d1c020d170d0f19151d051c1c131d071b171202000007170b18130c1b01<br>page  81:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fe27f7f7f7f7f7f7f7f7f7f7f7f7ffa<br>page  82:0000000000000000000000000000000000000000000000000000000000000000<br>page  83:0000000000000000000000000000000000000000000000000000000000000000<br>page  84:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f947f7f7f7f7fce<br>page  85:7f7f7f7f7f7f7f7f9a7fbf7f7f7f7f7f7f7f7f7faf7f7f7f7f7f7f7f7f7f7f7f<br>page  86:7f7f7f7f7f7f7fc57f7f7f7f7f7f7f7f7f7f7f7fca7f7fee7f7f7f7f7f7f7f7f<br>page  87:1805180d170e1802011c0f1b1d14110602191b18150d09030d111c1d0c031716<br>page  88:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fc47f7f7f7f7f7f7f7f7f7f7f7f<br>page  89:0000000000000000000000000000000000000000000000000000000000000000<br>page  90:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fc07f7f7f7f7f7f7f7fde7f7f7f7f7f7f<br>page  91:7f7f7f7f7f7f7f7f7f7f7f7fa57f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  92:0000000000000000000000000000000000000000000000000000000000000000<br>page  93:0a1a1907001905181505021c12130e0412071816001c01020904070b160c080f<br>page  94:1406190710140713080519110a1200040c1e0f021718181115061619170a1213<br>page  95:0a1d0f1d1e1915040012151d10151406131e0315130b18001b190e030e12070f<br>page  96:7f7f7f7f7f7f7f7f7f7f7f7f7f7fb67f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page  97:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fc87f7f7f7f7fe77f7f7f7f7f7f7f7f7f<br>page  98:15191803171a170e1503170818130f100201001804030b1e1b0919020c111e01<br>page  99:090b1304150b1204140a0e0c0e1509140109170113000e1b0010021a15171400<br>page 100:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fa77f7f7f7f7f7f7f7f7f7fe37f7f<br>page 101:0e0a00010b061005061416091a070a16011c020e1601191e0e030203170c1c0d<br>page 102:1d031b0116000d1a0c1c1612050a0c121e080f1c0a13171317061d0512091309<br>page 103:1e171c061012190e180c121a181400050f07021a1d090c19011303081901010c<br>page 104:7f7f7f7f7f7f7f7f7f7f7f7f80aa7f7f7f7f7f7f7f7f7f7f7f7f7f7ff07f7f7f<br>page 105:b37f7f7f7f7f7f7f7f7f7f7f7f937f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page 106:160a000e1001110a00050310011c1a1d091c1e170814120c090103040e131701<br>page 107:7f7f7f7f7f7f7f7f7f7f7f7f7f7ff17f7f7f7f7f7f7f7f7ff37f7f7f7f7f7f7f<br>page 108:83fee0da7fd47febbe9ed5ade4ac90d692d8c1f89fe1ede9a1e8c7c2a9d1dbff<br>page 109:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f827f7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page 110:1614041e0c120b010e0401131303110a0b180f1b120e130a03151318031c181c<br>page 111:08000115111d1d1c01171514161b130b10061200040a18160a1301051e080c11<br>page 112:19051e1302161e0c150906160019100303141b081e031a0c02080e181a041014<br>page 113:1d07111b1205071e091a181716181a01050f06100f03020019021d1e170d080c<br>page 114:0000000000000000000000000000000000000000000000000000000000000000<br>page 115:110601040d1406151a170d141e1b0a1505110b0d0d141a0e0417171d0c0e101b<br>page 116:0a130b11150f14171a05060f0f19101b180f190e0a0d0e1401161e0e02060307<br>page 117:1b0a170019111d0b130a18121e000401031c1d0e1d19181705110d1d05051404<br>page 118:1119021a1c05191a1b101206150c00040c1b111c1c02120a0f0e0e03190f130e<br>page 119:0000000000000000000000000000000000000000000000000000000000000000<br>page 120:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fcb7f7f7f7f7f7f7f7f7f7f7f7f7f<br>page 121:0000000000000000000000000000000000000000000000000000000000000000<br>page 122:051e0312041b1d18090717090d01040002020d1116040d13020d0b1d010c0c16<br>page 123:0000000000000000000000000000000000000000000000000000000000000000<br>page 124:0000000000000000000000000000000000000000000000000000000000000000<br>page 125:0000000000000000000000000000000000000000000000000000000000000000<br>page 126:7f7f7f7f7f7f7f7f8ce6cf7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f967f7f7f7f7f<br>page 127:7f7f7f7f7f7f7f7f7f7f7f7f7f7f7f7fdf7f7f7f7f7f7f7f7f7f7f7f7f957f7f<br></code></pre></td></tr></table></figure></details><p>并且根据模拟生成的<code>PDBR: 108</code>可以知道<code>Page 108</code>对应的内容即是第一级<code>PDE</code>的映射</p><p>接下来就可以进行计算了，这里取一个<code>vaild</code>和<code>invaild</code>的答案分析计算过程</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">Virtual Address 611c:<br>  --&gt; pde index:0x18 [decimal 24] pde contents:0xa1 (valid 1, pfn 0x21 [decimal 33])<br>    --&gt; pte index:0x8 [decimal 8] pte contents:0xb5 (valid 1, pfn 0x35 [decimal 53])<br>      --&gt; Translates to Physical Address 0x6bc --&gt; Value: 08<br>Virtual Address 3da8:<br>  --&gt; pde index:0xf [decimal 15] pde contents:0xd6 (valid 1, pfn 0x56 [decimal 86])<br>    --&gt; pte index:0xd [decimal 13] pte contents:0x7f (valid 0, pfn 0x7f [decimal 127])<br>      --&gt; Fault (page table entry not valid)<br></code></pre></td></tr></table></figure><p>Virtual Address <code>611c</code></p><ol><li><p>将611c按二进制转换为<code>Virtual Address Space</code>对应的 15 bits 为 <code>11000 01000 11100</code>。对<code>PDE</code>分割前五位有<code>11000(decimal 24)</code></p></li><li><p>这个时候对最顶层的<code>PDTR</code>对应的<code>Page 108</code>进行查表操作</p></li></ol><p>首先可以通过<code>Page Content</code>得到<code>Page 108</code>内容如下</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">Page 108: 83 fe e0 da 7f d4 7f eb be 9e d5 ad e4 ac 90 d6 92 d8 c1 f8 9f e1 ed e9 a1 e8 c7 c2 a9 d1 db ff<br>Index:    0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31<br></code></pre></td></tr></table></figure><p>通过查表找到对应<code>Index</code>的内容可以知道<code>24(11000)</code>对应位置的内容是<code>a1</code>，转换为二进制为<code>1010 0001</code>，读取最高位为<code>1</code>可以知道是<code>vaild</code>。再通过后面的<code>0010 0001</code>转换为十进制为<code>33</code>，因此再继续查询<code>Page 33</code>的内容</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">Page 33:7f 7f 7f 7f 7f 7f 7f 7f b5 7f 9d 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f 7f f6 b1 7f 7f 7f 7f<br>Index:  0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31<br></code></pre></td></tr></table></figure><p><code>611c</code>的[1-5]位为<code>PDE</code>，这时我们则需要通过[6-10]位来通过<code>PTE</code>寻找<code>VPN</code>对应的<code>PFN</code>地址。由<code>611c</code>为<code>11000 01000 11100</code>可以知道这次为<code>01000</code>即<code>(decmial 8)</code>，对照上面<code>page 33</code>可以发现第八个对应的内容为<code>53</code>，因此可以知道最终<code>VPN</code>对应上了<code>PFN</code>的<code>Page 53</code>。最后再通过<code>offset</code>的<code>11100</code>，配合<code>Page 53</code>对应的二进制<code>PFN</code>地址<code>11 0101</code>结合<code>offset</code>的<code>11100</code>有<code>110101 11100</code>，也就是最后答案的<code>0x6bc</code>，其中通过<code>offset</code>在<code>Page 53</code>中查表可以找到对应的 <code>Value</code> 为 <code>08</code></p><p>Virtual Address <code>3da8</code></p><ol><li><p>和<code>611c</code>同理，将<code>3da8</code>转为二进制<code>01111 01101 01000</code>，得到<code>pde index</code>为<code>01111(15)</code>，对应的<code>Value</code>为<code>0xd6(1101 0110)</code>，通过<code>1101 0110</code>最高位可以知道目标分页为<code>vaild</code>，去掉<code>vaild bit</code>可以得到索引的<code>pte</code>为<code>0x56(0101 0110 | 86)</code></p></li><li><p>检索<code>Page 86</code>，由<code>PTE index</code>为<code>01101</code>可以找到对应的<code>Value</code>为<code>0x7f(0111 1111)</code>由于最高位为<code>0</code>，因此是<code>invaild</code>，也就是说<code>pte</code>无效，无法访问</p></li></ol><p>其他的情况也是依次类推，即可算出结果是否有效</p></li><li><p>根据个人理解，具体缓存<code>hit</code>或<code>miss</code>的概率主要由对应内存上的数据决定。对于访问次数较多的内容<code>hit</code>缓存加快速度的概率自然更高；而对于不重复的多次查询（比如上面的练习），自然<code>miss</code>的概率会更高。因此对于进程来说，如果能将数据尽量集中在某一块分页上则能有效提高内存访问和处理的速度。</p></li></ol></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E7%9F%A5%E8%AF%86%E8%AE%B0%E5%BD%95/" class="category-chain-item">知识记录</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/OS/" class="print-no-link">#OS</a></div></div><div class="license-box my-3"><div class="license-title"><div>OSTEP：分页的计算</div><div>https://halc.top/p/c1ec22c4</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>HalcyonAzure</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年5月12日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/p/795cfa1d" title="总结：2022年5月"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">总结：2022年5月</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/p/20416971" title="OSTEP：TLB缓存命中和非命中的开销差距"><span class="hidden-mobile">OSTEP：TLB缓存命中和非命中的开销差距</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><script type="text/javascript">Fluid.utils.loadComments("#comments",(function(){var t=document.documentElement.getAttribute("data-user-color-scheme");t="dark"===t?"github-dark":"github-light",window.UtterancesThemeLight="github-light",window.UtterancesThemeDark="github-dark";var e=document.createElement("script");e.setAttribute("src","https://utteranc.es/client.js"),e.setAttribute("repo","HalcyonAzure/HalcyonAzure.github.io"),e.setAttribute("issue-term","title"),e.setAttribute("label","blog commit"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(e)}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a><div><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script src="/js/duration.js"></script></div></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/DynamicLine.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>